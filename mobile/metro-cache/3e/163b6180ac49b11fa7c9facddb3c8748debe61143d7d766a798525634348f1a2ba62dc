{"dependencies":[{"name":"@babel/runtime/helpers/interopRequireDefault","data":{"isAsync":false}},{"name":"@babel/runtime/regenerator","data":{"isAsync":false}},{"name":"react-native","data":{"isAsync":false}},{"name":"redux-saga/effects","data":{"isAsync":false}},{"name":"../../../services/api","data":{"isAsync":false}},{"name":"./actions","data":{"isAsync":false}}],"output":[{"data":{"code":"__d(function (global, _$$_REQUIRE, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  var _interopRequireDefault = _$$_REQUIRE(_dependencyMap[0], \"@babel/runtime/helpers/interopRequireDefault\");\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.SignIn = SignIn;\n  exports.signUp = signUp;\n  exports.setToken = setToken;\n  exports.signOut = signOut;\n  exports.default = void 0;\n\n  var _regenerator = _interopRequireDefault(_$$_REQUIRE(_dependencyMap[1], \"@babel/runtime/regenerator\"));\n\n  var _reactNative = _$$_REQUIRE(_dependencyMap[2], \"react-native\");\n\n  var _effects = _$$_REQUIRE(_dependencyMap[3], \"redux-saga/effects\");\n\n  var _api = _interopRequireDefault(_$$_REQUIRE(_dependencyMap[4], \"../../../services/api\"));\n\n  var _actions = _$$_REQUIRE(_dependencyMap[5], \"./actions\");\n\n  var _marked = _regenerator.default.mark(SignIn),\n      _marked2 = _regenerator.default.mark(signUp);\n\n  function SignIn(_ref) {\n    var payload, email, password, response, _response$data, token, user;\n\n    return _regenerator.default.wrap(function SignIn$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            payload = _ref.payload;\n            _context.prev = 1;\n            email = payload.email, password = payload.password;\n            _context.next = 5;\n            return (0, _effects.call)(_api.default.post, 'sessions', {\n              email: email,\n              password: password\n            });\n\n          case 5:\n            response = _context.sent;\n            _response$data = response.data, token = _response$data.token, user = _response$data.user;\n\n            if (user.provider) {\n              _reactNative.Alert.alert('Erro no login', 'O usuário não pode ser prestador de serviços');\n            }\n\n            _api.default.defaults.headers.Authorization = \"Bearer \" + token;\n            _context.next = 11;\n            return (0, _effects.put)((0, _actions.signInSuccess)(token, user));\n\n          case 11:\n            _context.next = 18;\n            break;\n\n          case 13:\n            _context.prev = 13;\n            _context.t0 = _context[\"catch\"](1);\n\n            _reactNative.Alert.alert('Falha de autenticação', 'Houve um erro no login, verifique seus dados');\n\n            _context.next = 18;\n            return (0, _effects.put)((0, _actions.signFailure)());\n\n          case 18:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _marked, null, [[1, 13]]);\n  }\n\n  function signUp(_ref2) {\n    var payload, name, email, password;\n    return _regenerator.default.wrap(function signUp$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            payload = _ref2.payload;\n            _context2.prev = 1;\n            name = payload.name, email = payload.email, password = payload.password;\n            _context2.next = 5;\n            return (0, _effects.call)(_api.default.post, 'users', {\n              name: name,\n              email: email,\n              password: password\n            });\n\n          case 5:\n            _context2.next = 12;\n            break;\n\n          case 7:\n            _context2.prev = 7;\n            _context2.t0 = _context2[\"catch\"](1);\n\n            _reactNative.Alert.alert('Falha no cadastro', 'Houve um erro no cadastro, verifique seus dados');\n\n            _context2.next = 12;\n            return (0, _effects.put)((0, _actions.signFailure)());\n\n          case 12:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _marked2, null, [[1, 7]]);\n  }\n\n  function setToken(_ref3) {\n    var payload = _ref3.payload;\n    if (!payload) return;\n    var token = payload.auth.token;\n\n    if (token) {\n      _api.default.defaults.headers.Authorization = \"Bearer \" + token;\n    }\n  }\n\n  function signOut() {\n    history.push('/');\n  }\n\n  var _default = (0, _effects.all)([(0, _effects.takeLatest)('persist/REHYDRATE', setToken), (0, _effects.takeLatest)('@auth/SIGN_IN_REQUEST', SignIn), (0, _effects.takeLatest)('@auth/SIGN_UP_REQUEST', signUp), (0, _effects.takeLatest)('@auth/SIGN_OUT', signOut)]);\n\n  exports.default = _default;\n});","map":[[15,0,1,0],[17,0,2,0],[19,0,4,0],[21,0,5,0],[23,42,7,17,"SignIn"],[23,48],[24,43,36,17,"signUp"],[24,49],[26,0,7,7],[26,11,7,17,"SignIn"],[26,17,7,7],[27,0,7,7],[29,0,7,7],[30,0,7,7],[31,0,7,7],[32,0,7,7],[33,0,7,26,"payload"],[33,12,7,26,"payload"],[33,19,7,7],[33,27,7,26,"payload"],[33,34,7,7],[34,0,7,7],[35,0,9,12,"email"],[35,12,9,12,"email"],[35,17,7,7],[35,20,9,32,"payload"],[35,27,7,7],[35,28,9,12,"email"],[35,33,7,7],[35,35,9,19,"password"],[35,43,7,7],[35,46,9,32,"payload"],[35,53,7,7],[35,54,9,19,"password"],[35,62,7,7],[36,0,7,7],[37,0,11,21],[37,19,11,27],[37,38,11,32,"api"],[37,51,11,36,"post"],[37,55,11,27],[37,57,11,42],[37,67,11,27],[37,69,11,54],[38,0,12,6,"email"],[38,14,12,6,"email"],[38,19,12,11],[38,21,12,6,"email"],[38,26,11,54],[39,0,13,6,"password"],[39,14,13,6,"password"],[39,22,13,14],[39,24,13,6,"password"],[40,0,11,54],[40,13,11,27],[40,14,11,21],[42,0,7,7],[43,0,11,10,"response"],[43,12,11,10,"response"],[43,20,7,7],[44,0,7,7],[44,29,16,28,"response"],[44,37,16,36],[44,38,16,37,"data"],[44,42,7,7],[44,44,16,12,"token"],[44,49,7,7],[44,67,16,12,"token"],[44,72,7,7],[44,74,16,19,"user"],[44,78,7,7],[44,96,16,19,"user"],[44,100,7,7],[46,0,17,4],[46,16,17,8,"user"],[46,20,17,12],[46,21,17,13,"provider"],[46,29,17,4],[46,31,17,23],[47,0,18,6,"Alert"],[47,33,18,12,"alert"],[47,38,18,6],[47,39,19,8],[47,54,18,6],[47,56,20,8],[47,102,18,6],[48,0,22,5],[50,0,23,4,"api"],[50,25,23,8,"defaults"],[50,33,23,4],[50,34,23,17,"headers"],[50,41,23,4],[50,42,23,25,"Authorization"],[50,55,23,4],[50,70,23,51,"token"],[50,75,23,4],[51,0,7,7],[52,0,25,4],[52,19,25,10],[52,37,25,14],[52,65,25,28,"token"],[52,70,25,14],[52,72,25,35,"user"],[52,76,25,14],[52,77,25,10],[52,78,25,4],[54,0,7,7],[55,0,7,7],[56,0,7,7],[58,0,7,7],[59,0,7,7],[60,0,7,7],[62,0,28,4,"Alert"],[62,31,28,10,"alert"],[62,36,28,4],[62,37,29,6],[62,60,28,4],[62,62,30,6],[62,108,28,4],[64,0,7,7],[65,0,33,4],[65,19,33,10],[65,37,33,14],[65,64,33,10],[65,65,33,4],[67,0,7,7],[68,0,7,7],[69,0,7,7],[70,0,7,7],[71,0,7,7],[72,0,7,7],[73,0,7,7],[75,0,36,7],[75,11,36,17,"signUp"],[75,17,36,7],[76,0,36,7],[77,0,36,7],[78,0,36,7],[79,0,36,7],[80,0,36,7],[81,0,36,26,"payload"],[81,12,36,26,"payload"],[81,19,36,7],[81,28,36,26,"payload"],[81,35,36,7],[82,0,36,7],[83,0,38,12,"name"],[83,12,38,12,"name"],[83,16,36,7],[83,19,38,38,"payload"],[83,26,36,7],[83,27,38,12,"name"],[83,31,36,7],[83,33,38,18,"email"],[83,38,36,7],[83,41,38,38,"payload"],[83,48,36,7],[83,49,38,18,"email"],[83,54,36,7],[83,56,38,25,"password"],[83,64,36,7],[83,67,38,38,"payload"],[83,74,36,7],[83,75,38,25,"password"],[83,83,36,7],[84,0,36,7],[85,0,40,4],[85,19,40,10],[85,38,40,15,"api"],[85,51,40,19,"post"],[85,55,40,10],[85,57,40,25],[85,64,40,10],[85,66,40,34],[86,0,41,6,"name"],[86,14,41,6,"name"],[86,18,41,10],[86,20,41,6,"name"],[86,24,40,34],[87,0,42,6,"email"],[87,14,42,6,"email"],[87,19,42,11],[87,21,42,6,"email"],[87,26,40,34],[88,0,43,6,"password"],[88,14,43,6,"password"],[88,22,43,14],[88,24,43,6,"password"],[89,0,40,34],[89,13,40,10],[89,14,40,4],[91,0,36,7],[92,0,36,7],[93,0,36,7],[95,0,36,7],[96,0,36,7],[97,0,36,7],[99,0,47,4,"Alert"],[99,31,47,10,"alert"],[99,36,47,4],[99,37,48,6],[99,56,47,4],[99,58,49,6],[99,107,47,4],[101,0,36,7],[102,0,52,4],[102,19,52,10],[102,37,52,14],[102,64,52,10],[102,65,52,4],[104,0,36,7],[105,0,36,7],[106,0,36,7],[107,0,36,7],[108,0,36,7],[109,0,36,7],[110,0,36,7],[112,0,55,7],[112,11,55,16,"setToken"],[112,19,55,7],[112,27,55,38],[113,0,55,38],[113,8,55,27,"payload"],[113,15,55,38],[113,24,55,27,"payload"],[113,31,55,38],[114,0,56,2],[114,8,56,6],[114,9,56,7,"payload"],[114,16,56,2],[114,18,56,16],[115,0,55,38],[115,8,57,10,"token"],[115,13,55,38],[115,16,57,20,"payload"],[115,23,57,27],[115,24,57,28,"auth"],[115,28,55,38],[115,29,57,10,"token"],[115,34,55,38],[117,0,59,2],[117,8,59,6,"token"],[117,13,59,2],[117,15,59,13],[118,0,60,4,"api"],[118,19,60,8,"defaults"],[118,27,60,4],[118,28,60,17,"headers"],[118,35,60,4],[118,36,60,25,"Authorization"],[118,49,60,4],[118,64,60,51,"token"],[118,69,60,4],[119,0,61,3],[120,0,62,1],[122,0,63,7],[122,11,63,16,"signOut"],[122,18,63,7],[122,21,63,26],[123,0,64,2,"history"],[123,4,64,2,"history"],[123,11,64,9],[123,12,64,10,"push"],[123,16,64,2],[123,17,64,15],[123,20,64,2],[124,0,65,1],[126,17,67,15],[126,35,67,19],[126,36,68,2],[126,61,68,13],[126,80,68,2],[126,82,68,34,"setToken"],[126,90,68,2],[126,91,67,19],[126,93,69,2],[126,118,69,13],[126,141,69,2],[126,143,69,38,"SignIn"],[126,149,69,2],[126,150,67,19],[126,152,70,2],[126,177,70,13],[126,200,70,2],[126,202,70,38,"signUp"],[126,208,70,2],[126,209,67,19],[126,211,71,2],[126,236,71,13],[126,252,71,2],[126,254,71,31,"signOut"],[126,261,71,2],[126,262,67,19],[126,263,67,15],[126,264]]},"type":"js/module"}]}