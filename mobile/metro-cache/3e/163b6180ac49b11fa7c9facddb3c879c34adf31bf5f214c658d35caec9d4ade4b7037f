{"dependencies":[{"name":"@babel/runtime/helpers/interopRequireDefault","data":{"isAsync":false}},{"name":"@babel/runtime/regenerator","data":{"isAsync":false}},{"name":"react-native","data":{"isAsync":false}},{"name":"redux-saga/effects","data":{"isAsync":false}},{"name":"../../../services/api","data":{"isAsync":false}},{"name":"./actions","data":{"isAsync":false}}],"output":[{"data":{"code":"__d(function (global, _$$_REQUIRE, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  var _interopRequireDefault = _$$_REQUIRE(_dependencyMap[0], \"@babel/runtime/helpers/interopRequireDefault\");\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.signIn = signIn;\n  exports.signUp = signUp;\n  exports.setToken = setToken;\n  exports.default = void 0;\n\n  var _regenerator = _interopRequireDefault(_$$_REQUIRE(_dependencyMap[1], \"@babel/runtime/regenerator\"));\n\n  var _reactNative = _$$_REQUIRE(_dependencyMap[2], \"react-native\");\n\n  var _effects = _$$_REQUIRE(_dependencyMap[3], \"redux-saga/effects\");\n\n  var _api = _interopRequireDefault(_$$_REQUIRE(_dependencyMap[4], \"../../../services/api\"));\n\n  var _actions = _$$_REQUIRE(_dependencyMap[5], \"./actions\");\n\n  var _marked = _regenerator.default.mark(signIn),\n      _marked2 = _regenerator.default.mark(signUp);\n\n  function signIn(_ref) {\n    var payload, email, password, response, _response$data, token, user;\n\n    return _regenerator.default.wrap(function signIn$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            payload = _ref.payload;\n            _context.prev = 1;\n            email = payload.email, password = payload.password;\n            _context.next = 5;\n            return (0, _effects.call)(_api.default.post, 'sessions', {\n              email: email,\n              password: password\n            });\n\n          case 5:\n            response = _context.sent;\n            _response$data = response.data, token = _response$data.token, user = _response$data.user;\n\n            if (!user.provider) {\n              _context.next = 10;\n              break;\n            }\n\n            _reactNative.Alert.alert('Erro no login', 'O usuário não pode ser prestador de serviços');\n\n            return _context.abrupt(\"return\");\n\n          case 10:\n            _api.default.defaults.headers.Authorization = \"Bearer \" + token;\n            _context.next = 13;\n            return (0, _effects.put)((0, _actions.signInSuccess)(token, user));\n\n          case 13:\n            _context.next = 20;\n            break;\n\n          case 15:\n            _context.prev = 15;\n            _context.t0 = _context[\"catch\"](1);\n\n            _reactNative.Alert.alert('Falha de autenticação', 'Houve um erro no login, verifique seus dados');\n\n            _context.next = 20;\n            return (0, _effects.put)((0, _actions.signFailure)());\n\n          case 20:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _marked, null, [[1, 15]]);\n  }\n\n  function signUp(_ref2) {\n    var payload, name, email, password;\n    return _regenerator.default.wrap(function signUp$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            payload = _ref2.payload;\n            _context2.prev = 1;\n            name = payload.name, email = payload.email, password = payload.password;\n            _context2.next = 5;\n            return (0, _effects.call)(_api.default.post, 'users', {\n              name: name,\n              email: email,\n              password: password\n            });\n\n          case 5:\n            _context2.next = 12;\n            break;\n\n          case 7:\n            _context2.prev = 7;\n            _context2.t0 = _context2[\"catch\"](1);\n\n            _reactNative.Alert.alert('Falha no cadastro', 'Houve um erro no cadastro, verifique seus dados');\n\n            _context2.next = 12;\n            return (0, _effects.put)((0, _actions.signFailure)());\n\n          case 12:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _marked2, null, [[1, 7]]);\n  }\n\n  function setToken(_ref3) {\n    var payload = _ref3.payload;\n    if (!payload) return;\n    var token = payload.auth.token;\n\n    if (token) {\n      _api.default.defaults.headers.Authorization = \"Bearer \" + token;\n    }\n  }\n\n  var _default = (0, _effects.all)([(0, _effects.takeLatest)('persist/REHYDRATE', setToken), (0, _effects.takeLatest)('@auth/SIGN_IN_REQUEST', signIn), (0, _effects.takeLatest)('@auth/SIGN_UP_REQUEST', signUp)]);\n\n  exports.default = _default;\n});","map":[[14,0,1,0],[16,0,2,0],[18,0,4,0],[20,0,5,0],[22,42,7,17,"signIn"],[22,48],[23,43,37,17,"signUp"],[23,49],[25,0,7,7],[25,11,7,17,"signIn"],[25,17,7,7],[26,0,7,7],[28,0,7,7],[29,0,7,7],[30,0,7,7],[31,0,7,7],[32,0,7,26,"payload"],[32,12,7,26,"payload"],[32,19,7,7],[32,27,7,26,"payload"],[32,34,7,7],[33,0,7,7],[34,0,9,12,"email"],[34,12,9,12,"email"],[34,17,7,7],[34,20,9,32,"payload"],[34,27,7,7],[34,28,9,12,"email"],[34,33,7,7],[34,35,9,19,"password"],[34,43,7,7],[34,46,9,32,"payload"],[34,53,7,7],[34,54,9,19,"password"],[34,62,7,7],[35,0,7,7],[36,0,11,21],[36,19,11,27],[36,38,11,32,"api"],[36,51,11,36,"post"],[36,55,11,27],[36,57,11,42],[36,67,11,27],[36,69,11,54],[37,0,12,6,"email"],[37,14,12,6,"email"],[37,19,12,11],[37,21,12,6,"email"],[37,26,11,54],[38,0,13,6,"password"],[38,14,13,6,"password"],[38,22,13,14],[38,24,13,6,"password"],[39,0,11,54],[39,13,11,27],[39,14,11,21],[41,0,7,7],[42,0,11,10,"response"],[42,12,11,10,"response"],[42,20,7,7],[43,0,7,7],[43,29,16,28,"response"],[43,37,16,36],[43,38,16,37,"data"],[43,42,7,7],[43,44,16,12,"token"],[43,49,7,7],[43,67,16,12,"token"],[43,72,7,7],[43,74,16,19,"user"],[43,78,7,7],[43,96,16,19,"user"],[43,100,7,7],[45,0,7,7],[45,17,17,8,"user"],[45,21,17,12],[45,22,17,13,"provider"],[45,30,7,7],[46,0,7,7],[47,0,7,7],[48,0,7,7],[50,0,18,6,"Alert"],[50,31,18,12,"alert"],[50,36,18,6],[50,37,19,8],[50,52,18,6],[50,54,20,8],[50,100,18,6],[52,0,7,7],[54,0,7,7],[55,0,24,4,"api"],[55,25,24,8,"defaults"],[55,33,24,4],[55,34,24,17,"headers"],[55,41,24,4],[55,42,24,25,"Authorization"],[55,55,24,4],[55,70,24,51,"token"],[55,75,24,4],[56,0,7,7],[57,0,26,4],[57,19,26,10],[57,37,26,14],[57,65,26,28,"token"],[57,70,26,14],[57,72,26,35,"user"],[57,76,26,14],[57,77,26,10],[57,78,26,4],[59,0,7,7],[60,0,7,7],[61,0,7,7],[63,0,7,7],[64,0,7,7],[65,0,7,7],[67,0,29,4,"Alert"],[67,31,29,10,"alert"],[67,36,29,4],[67,37,30,6],[67,60,29,4],[67,62,31,6],[67,108,29,4],[69,0,7,7],[70,0,34,4],[70,19,34,10],[70,37,34,14],[70,64,34,10],[70,65,34,4],[72,0,7,7],[73,0,7,7],[74,0,7,7],[75,0,7,7],[76,0,7,7],[77,0,7,7],[78,0,7,7],[80,0,37,7],[80,11,37,17,"signUp"],[80,17,37,7],[81,0,37,7],[82,0,37,7],[83,0,37,7],[84,0,37,7],[85,0,37,7],[86,0,37,26,"payload"],[86,12,37,26,"payload"],[86,19,37,7],[86,28,37,26,"payload"],[86,35,37,7],[87,0,37,7],[88,0,39,12,"name"],[88,12,39,12,"name"],[88,16,37,7],[88,19,39,38,"payload"],[88,26,37,7],[88,27,39,12,"name"],[88,31,37,7],[88,33,39,18,"email"],[88,38,37,7],[88,41,39,38,"payload"],[88,48,37,7],[88,49,39,18,"email"],[88,54,37,7],[88,56,39,25,"password"],[88,64,37,7],[88,67,39,38,"payload"],[88,74,37,7],[88,75,39,25,"password"],[88,83,37,7],[89,0,37,7],[90,0,41,4],[90,19,41,10],[90,38,41,15,"api"],[90,51,41,19,"post"],[90,55,41,10],[90,57,41,25],[90,64,41,10],[90,66,41,34],[91,0,42,6,"name"],[91,14,42,6,"name"],[91,18,42,10],[91,20,42,6,"name"],[91,24,41,34],[92,0,43,6,"email"],[92,14,43,6,"email"],[92,19,43,11],[92,21,43,6,"email"],[92,26,41,34],[93,0,44,6,"password"],[93,14,44,6,"password"],[93,22,44,14],[93,24,44,6,"password"],[94,0,41,34],[94,13,41,10],[94,14,41,4],[96,0,37,7],[97,0,37,7],[98,0,37,7],[100,0,37,7],[101,0,37,7],[102,0,37,7],[104,0,48,4,"Alert"],[104,31,48,10,"alert"],[104,36,48,4],[104,37,49,6],[104,56,48,4],[104,58,50,6],[104,107,48,4],[106,0,37,7],[107,0,53,4],[107,19,53,10],[107,37,53,14],[107,64,53,10],[107,65,53,4],[109,0,37,7],[110,0,37,7],[111,0,37,7],[112,0,37,7],[113,0,37,7],[114,0,37,7],[115,0,37,7],[117,0,56,7],[117,11,56,16,"setToken"],[117,19,56,7],[117,27,56,38],[118,0,56,38],[118,8,56,27,"payload"],[118,15,56,38],[118,24,56,27,"payload"],[118,31,56,38],[119,0,57,2],[119,8,57,6],[119,9,57,7,"payload"],[119,16,57,2],[119,18,57,16],[120,0,56,38],[120,8,58,10,"token"],[120,13,56,38],[120,16,58,20,"payload"],[120,23,58,27],[120,24,58,28,"auth"],[120,28,56,38],[120,29,58,10,"token"],[120,34,56,38],[122,0,60,2],[122,8,60,6,"token"],[122,13,60,2],[122,15,60,13],[123,0,61,4,"api"],[123,19,61,8,"defaults"],[123,27,61,4],[123,28,61,17,"headers"],[123,35,61,4],[123,36,61,25,"Authorization"],[123,49,61,4],[123,64,61,51,"token"],[123,69,61,4],[124,0,62,3],[125,0,63,1],[127,17,65,15],[127,35,65,19],[127,36,66,2],[127,61,66,13],[127,80,66,2],[127,82,66,34,"setToken"],[127,90,66,2],[127,91,65,19],[127,93,67,2],[127,118,67,13],[127,141,67,2],[127,143,67,38,"signIn"],[127,149,67,2],[127,150,65,19],[127,152,68,2],[127,177,68,13],[127,200,68,2],[127,202,68,38,"signUp"],[127,208,68,2],[127,209,65,19],[127,210,65,15],[127,211]]},"type":"js/module"}]}