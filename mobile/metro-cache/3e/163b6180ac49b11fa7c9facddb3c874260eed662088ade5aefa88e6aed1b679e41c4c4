{"dependencies":[{"name":"@babel/runtime/helpers/interopRequireDefault","data":{"isAsync":false}},{"name":"@babel/runtime/regenerator","data":{"isAsync":false}},{"name":"react-native","data":{"isAsync":false}},{"name":"redux-saga/effects","data":{"isAsync":false}},{"name":"../../../services/api","data":{"isAsync":false}},{"name":"./actions","data":{"isAsync":false}}],"output":[{"data":{"code":"__d(function (global, _$$_REQUIRE, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  var _interopRequireDefault = _$$_REQUIRE(_dependencyMap[0], \"@babel/runtime/helpers/interopRequireDefault\");\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.signIn = signIn;\n  exports.signUp = signUp;\n  exports.setToken = setToken;\n  exports.signOut = signOut;\n  exports.default = void 0;\n\n  var _regenerator = _interopRequireDefault(_$$_REQUIRE(_dependencyMap[1], \"@babel/runtime/regenerator\"));\n\n  var _reactNative = _$$_REQUIRE(_dependencyMap[2], \"react-native\");\n\n  var _effects = _$$_REQUIRE(_dependencyMap[3], \"redux-saga/effects\");\n\n  var _api = _interopRequireDefault(_$$_REQUIRE(_dependencyMap[4], \"../../../services/api\"));\n\n  var _actions = _$$_REQUIRE(_dependencyMap[5], \"./actions\");\n\n  var _marked = _regenerator.default.mark(signIn),\n      _marked2 = _regenerator.default.mark(signUp);\n\n  function signIn(_ref) {\n    var payload, email, password, response, _response$data, token, user;\n\n    return _regenerator.default.wrap(function signIn$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            payload = _ref.payload;\n            _context.prev = 1;\n            email = payload.email, password = payload.password;\n            _context.next = 5;\n            return (0, _effects.call)(_api.default.post, 'sessions', {\n              email: email,\n              password: password\n            });\n\n          case 5:\n            response = _context.sent;\n            _response$data = response.data, token = _response$data.token, user = _response$data.user;\n\n            if (!user.provider) {\n              _context.next = 10;\n              break;\n            }\n\n            _reactNative.Alert.alert('Erro no login', 'O usuário não pode ser prestador de serviços');\n\n            return _context.abrupt(\"return\");\n\n          case 10:\n            _api.default.defaults.headers.Authorization = \"Bearer \" + token;\n            _context.next = 13;\n            return (0, _effects.put)((0, _actions.signInSuccess)(token, user));\n\n          case 13:\n            _context.next = 20;\n            break;\n\n          case 15:\n            _context.prev = 15;\n            _context.t0 = _context[\"catch\"](1);\n\n            _reactNative.Alert.alert('Falha de autenticação', 'Houve um erro no login, verifique seus dados');\n\n            _context.next = 20;\n            return (0, _effects.put)((0, _actions.signFailure)());\n\n          case 20:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _marked, null, [[1, 15]]);\n  }\n\n  function signUp(_ref2) {\n    var payload, name, email, password;\n    return _regenerator.default.wrap(function signUp$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            payload = _ref2.payload;\n            _context2.prev = 1;\n            name = payload.name, email = payload.email, password = payload.password;\n            _context2.next = 5;\n            return (0, _effects.call)(_api.default.post, 'users', {\n              name: name,\n              email: email,\n              password: password\n            });\n\n          case 5:\n            _context2.next = 12;\n            break;\n\n          case 7:\n            _context2.prev = 7;\n            _context2.t0 = _context2[\"catch\"](1);\n\n            _reactNative.Alert.alert('Falha no cadastro', 'Houve um erro no cadastro, verifique seus dados');\n\n            _context2.next = 12;\n            return (0, _effects.put)((0, _actions.signFailure)());\n\n          case 12:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _marked2, null, [[1, 7]]);\n  }\n\n  function setToken(_ref3) {\n    var payload = _ref3.payload;\n    if (!payload) return;\n    var token = payload.auth.token;\n\n    if (token) {\n      _api.default.defaults.headers.Authorization = \"Bearer \" + token;\n    }\n  }\n\n  function signOut() {}\n\n  var _default = (0, _effects.all)([(0, _effects.takeLatest)('persist/REHYDRATE', setToken), (0, _effects.takeLatest)('@auth/SIGN_IN_REQUEST', SignIn), (0, _effects.takeLatest)('@auth/SIGN_UP_REQUEST', signUp), (0, _effects.takeLatest)('@auth/SIGN_OUT', signOut)]);\n\n  exports.default = _default;\n});","map":[[15,0,1,0],[17,0,2,0],[19,0,4,0],[21,0,5,0],[23,42,7,17,"signIn"],[23,48],[24,43,37,17,"signUp"],[24,49],[26,0,7,7],[26,11,7,17,"signIn"],[26,17,7,7],[27,0,7,7],[29,0,7,7],[30,0,7,7],[31,0,7,7],[32,0,7,7],[33,0,7,26,"payload"],[33,12,7,26,"payload"],[33,19,7,7],[33,27,7,26,"payload"],[33,34,7,7],[34,0,7,7],[35,0,9,12,"email"],[35,12,9,12,"email"],[35,17,7,7],[35,20,9,32,"payload"],[35,27,7,7],[35,28,9,12,"email"],[35,33,7,7],[35,35,9,19,"password"],[35,43,7,7],[35,46,9,32,"payload"],[35,53,7,7],[35,54,9,19,"password"],[35,62,7,7],[36,0,7,7],[37,0,11,21],[37,19,11,27],[37,38,11,32,"api"],[37,51,11,36,"post"],[37,55,11,27],[37,57,11,42],[37,67,11,27],[37,69,11,54],[38,0,12,6,"email"],[38,14,12,6,"email"],[38,19,12,11],[38,21,12,6,"email"],[38,26,11,54],[39,0,13,6,"password"],[39,14,13,6,"password"],[39,22,13,14],[39,24,13,6,"password"],[40,0,11,54],[40,13,11,27],[40,14,11,21],[42,0,7,7],[43,0,11,10,"response"],[43,12,11,10,"response"],[43,20,7,7],[44,0,7,7],[44,29,16,28,"response"],[44,37,16,36],[44,38,16,37,"data"],[44,42,7,7],[44,44,16,12,"token"],[44,49,7,7],[44,67,16,12,"token"],[44,72,7,7],[44,74,16,19,"user"],[44,78,7,7],[44,96,16,19,"user"],[44,100,7,7],[46,0,7,7],[46,17,17,8,"user"],[46,21,17,12],[46,22,17,13,"provider"],[46,30,7,7],[47,0,7,7],[48,0,7,7],[49,0,7,7],[51,0,18,6,"Alert"],[51,31,18,12,"alert"],[51,36,18,6],[51,37,19,8],[51,52,18,6],[51,54,20,8],[51,100,18,6],[53,0,7,7],[55,0,7,7],[56,0,24,4,"api"],[56,25,24,8,"defaults"],[56,33,24,4],[56,34,24,17,"headers"],[56,41,24,4],[56,42,24,25,"Authorization"],[56,55,24,4],[56,70,24,51,"token"],[56,75,24,4],[57,0,7,7],[58,0,26,4],[58,19,26,10],[58,37,26,14],[58,65,26,28,"token"],[58,70,26,14],[58,72,26,35,"user"],[58,76,26,14],[58,77,26,10],[58,78,26,4],[60,0,7,7],[61,0,7,7],[62,0,7,7],[64,0,7,7],[65,0,7,7],[66,0,7,7],[68,0,29,4,"Alert"],[68,31,29,10,"alert"],[68,36,29,4],[68,37,30,6],[68,60,29,4],[68,62,31,6],[68,108,29,4],[70,0,7,7],[71,0,34,4],[71,19,34,10],[71,37,34,14],[71,64,34,10],[71,65,34,4],[73,0,7,7],[74,0,7,7],[75,0,7,7],[76,0,7,7],[77,0,7,7],[78,0,7,7],[79,0,7,7],[81,0,37,7],[81,11,37,17,"signUp"],[81,17,37,7],[82,0,37,7],[83,0,37,7],[84,0,37,7],[85,0,37,7],[86,0,37,7],[87,0,37,26,"payload"],[87,12,37,26,"payload"],[87,19,37,7],[87,28,37,26,"payload"],[87,35,37,7],[88,0,37,7],[89,0,39,12,"name"],[89,12,39,12,"name"],[89,16,37,7],[89,19,39,38,"payload"],[89,26,37,7],[89,27,39,12,"name"],[89,31,37,7],[89,33,39,18,"email"],[89,38,37,7],[89,41,39,38,"payload"],[89,48,37,7],[89,49,39,18,"email"],[89,54,37,7],[89,56,39,25,"password"],[89,64,37,7],[89,67,39,38,"payload"],[89,74,37,7],[89,75,39,25,"password"],[89,83,37,7],[90,0,37,7],[91,0,41,4],[91,19,41,10],[91,38,41,15,"api"],[91,51,41,19,"post"],[91,55,41,10],[91,57,41,25],[91,64,41,10],[91,66,41,34],[92,0,42,6,"name"],[92,14,42,6,"name"],[92,18,42,10],[92,20,42,6,"name"],[92,24,41,34],[93,0,43,6,"email"],[93,14,43,6,"email"],[93,19,43,11],[93,21,43,6,"email"],[93,26,41,34],[94,0,44,6,"password"],[94,14,44,6,"password"],[94,22,44,14],[94,24,44,6,"password"],[95,0,41,34],[95,13,41,10],[95,14,41,4],[97,0,37,7],[98,0,37,7],[99,0,37,7],[101,0,37,7],[102,0,37,7],[103,0,37,7],[105,0,48,4,"Alert"],[105,31,48,10,"alert"],[105,36,48,4],[105,37,49,6],[105,56,48,4],[105,58,50,6],[105,107,48,4],[107,0,37,7],[108,0,53,4],[108,19,53,10],[108,37,53,14],[108,64,53,10],[108,65,53,4],[110,0,37,7],[111,0,37,7],[112,0,37,7],[113,0,37,7],[114,0,37,7],[115,0,37,7],[116,0,37,7],[118,0,56,7],[118,11,56,16,"setToken"],[118,19,56,7],[118,27,56,38],[119,0,56,38],[119,8,56,27,"payload"],[119,15,56,38],[119,24,56,27,"payload"],[119,31,56,38],[120,0,57,2],[120,8,57,6],[120,9,57,7,"payload"],[120,16,57,2],[120,18,57,16],[121,0,56,38],[121,8,58,10,"token"],[121,13,56,38],[121,16,58,20,"payload"],[121,23,58,27],[121,24,58,28,"auth"],[121,28,56,38],[121,29,58,10,"token"],[121,34,56,38],[123,0,60,2],[123,8,60,6,"token"],[123,13,60,2],[123,15,60,13],[124,0,61,4,"api"],[124,19,61,8,"defaults"],[124,27,61,4],[124,28,61,17,"headers"],[124,35,61,4],[124,36,61,25,"Authorization"],[124,49,61,4],[124,64,61,51,"token"],[124,69,61,4],[125,0,62,3],[126,0,63,1],[128,0,64,7],[128,11,64,16,"signOut"],[128,18,64,7],[128,21,64,26],[128,22,66,1],[130,17,68,15],[130,35,68,19],[130,36,69,2],[130,61,69,13],[130,80,69,2],[130,82,69,34,"setToken"],[130,90,69,2],[130,91,68,19],[130,93,70,2],[130,118,70,13],[130,141,70,2],[130,143,70,38,"SignIn"],[130,149,70,2],[130,150,68,19],[130,152,71,2],[130,177,71,13],[130,200,71,2],[130,202,71,38,"signUp"],[130,208,71,2],[130,209,68,19],[130,211,72,2],[130,236,72,13],[130,252,72,2],[130,254,72,31,"signOut"],[130,261,72,2],[130,262,68,19],[130,263,68,15],[130,264]]},"type":"js/module"}]}